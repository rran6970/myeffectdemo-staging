{% extends '_public_base.html' %}
{% load i18n %}

{% block title %} My Effect - {%trans "My Actions" %} {% endblock %}

{% block css %}
  <script src="{{ STATIC_URL }}bower_components/webcomponentsjs/webcomponents.min.js"></script>
  <link href="{{ STATIC_URL }}css/mycleancity.css" rel="stylesheet">
  <link rel="import" href="{{ STATIC_URL }}bower_components/core-tooltip/core-tooltip.html">
{% endblock %}

{% block content %}

<div class="wrapper public">
  <div class="clouds"></div>

  {% include "_navbar.html" %}

  <a href="/" class="logo"></a>

  <div class="content my-challenges">
    <div class="container">
      	<div id="sign-my-actions"></div>

      	{% if user.profile.is_clean_ambassador %}
        <div id="white-box" class="posted-challenges">
			<h1>{{ user.profile.clean_team_member.clean_team.name }} {%trans "Posted Actions" %}</h1>
	
			{% if posted_challenges %}
				{% for challenge in posted_challenges %}
					<div class="challenges">
						{% if challenge.national_challenge %}
						<img class="badge-icon" src="{{ STATIC_URL }}images/badge-nc-62x45.png" alt="National Challenge" />
						{% endif %}
						<a href="/challenges/{{ challenge.id }}/"><h1>{{ challenge.title }}</h1></a>

						<div class="links">
							{% if user.profile.is_manager %}
							<a class="export-challenge-data" href="/challenges/export-data/{{ challenge.id }}/">{%trans "Export User Data" %}</a>
							{% endif %}
							<a class="view-participants" class="btn btn-primary" href="/challenges/participants/{{ challenge.id }}/">{%trans "View Participants" %}</a>
							<div class="clear"></div>
							<a class="edit-challenge" class="btn btn-primary" href="/challenges/edit/{{ challenge.id }}/">{%trans "Edit Action" %}</a>

							{% if challenge.type.challenge_type == "one-time" %}
							<a class="view-challenge-qrcode popup-image" href="#view-challenge-qrcode-{{ challenge.id }}"><img src="{{ MEDIA_URL }}{{ challenge.qr_code.qr_image }}" alt="" /></a>
							{% endif %}
						</div>

						<div class="details">
							<div class="title">
								<p><span>{%trans "Last updated by:" %}</span>&nbsp;{{ challenge.last_updated_by.first_name }} {{ challenge.last_updated_by.last_name }}</p>
							</div>

							<div class="title">
								<p><span>{%trans "Starts:" %}</span>&nbsp;{{ challenge.event_start_date }} {%trans "at" %} {{ challenge.event_start_time }}</span></p>
							</div>
							<div class="title">
								<p><span>{%trans "Ends:" %}</span>&nbsp;{{ challenge.event_end_date }} {%trans "at" %} {{ challenge.event_end_time }}</span></p>
							</div>

							<div class="title">
								<p><span>{%trans "Location:" %}</span>&nbsp;{{ challenge.city }}, {{ challenge.province }}</p>
							</div>

							<div class="title">
								<p><span>{{ challenge.clean_creds_per_hour }}&nbsp;</span><span class="blue bold">{%trans "Change" %}</span> <span class="gold bold">{%trans "Creds" %}</span><span>{% if challenge.type.challenge_type == "hourly" %}/hr{% endif %}</span></p>
							</div>
						</div>
					</div>
				{% endfor %}
			{% else %}
				<p>{%trans "There are no Actions that you've posted." %}</p>
			{% endif %}
        </div><!-- /#white-box -->
		{% endif %}

      	<div id="white-box" class="user-challenges" {% if not user.profile.is_clean_ambassador %}style="left: 30%; width: 600px;"{% endif %}>
	      	<h1>{{ user.first_name }}'s {%trans "Actions" %}</h1>
			
			<div class="title">
				<p><span>{%trans "Total Hours:" %}</span>&nbsp;{{ total_hours }}</span></p>
			</div>
			{% if user_challenges %}
				<div class="table-container">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>{%trans "Status" %}</th>
								<th>{%trans "Actions" %}</th>
								<th>{%trans "Hours" %}</th>
								<th id="clean-creds"><span class="blue bold">{%trans "Change" %}</span> <span class="gold bold">{%trans "Creds" %}</span></th>
							</tr>
						</thead>
						<tbody>
							{% for challenge in user_challenges %}
							<tr>
								<td class="icon">
									{% if challenge.time_out %}
									<img title="Challenge is complete" class="status-icon" src="{{ STATIC_URL }}images/32x32-complete.png" alt="" />
									{% else %}
										{% if challenge.time_in %}
										<img title="You are checked in to a challenge"  class="status-icon" src="{{ STATIC_URL }}images/32x32-checked-in.png" alt="" />
										{% else %}
										<img title="Challenge not started yet" class="status-icon" src="{{ STATIC_URL }}images/32x32-red-circle.png" alt="" />
										{% endif %}
									{% endif %}
								</td>
								<td class="challenge">
									<div class="challenge-info">
										<a href="/challenges/{{ challenge.challenge.id }}/"><h1>{{ challenge.challenge.title }}</h1></a>
										{% if challenge.challenge_id in has_file %}
										<a href="/challenges/downloadforms/{{ challenge.challenge.id }}/" class="download_file_box" >{%trans "Download Forms" %}</a>
										{% endif %}
										{% if challenge.time_in %}
										<span class="total-hours">{%trans "Checked in on" %} {{ challenge.time_in }}</span>
										{% else %}
										<span class="total-hours">{%trans "Not checked in" %}</span>
										{% endif %}
									</div>
								</td>
								<td class="total-hours">
									{{ challenge.total_hours }}
								</td>
								<td class="total-clean-creds">
									{{ challenge.total_clean_creds }}
								</td>
							</tr>
							{% endfor %}

							{% if clean_team_challenges %}
							{% for challenge in clean_team_challenges %}
							<tr>
								<td class="icon">
									{% if challenge.time_out %}
									<img title="Challenge is complete" class="status-icon" src="{{ STATIC_URL }}images/32x32-complete.png" alt="" />
									{% else %}
										{% if challenge.time_in %}
										<img title="You are checked in to a challenge"  class="status-icon" src="{{ STATIC_URL }}images/32x32-checked-in.png" alt="" />
										{% else %}
										<img title="Challenge not started yet" class="status-icon" src="{{ STATIC_URL }}images/32x32-red-circle.png" alt="" />
										{% endif %}
									{% endif %}
								</td>
								<td class="challenge">
									<div class="challenge-info">
										<a href="/challenges/{{ challenge.challenge.id }}/"><h1>{{ challenge.challenge.title }}</h1></a>
												
										{% if challenge.challenge.url == "staples-cleanact" %}
											<span>
												{%trans "Store" %} {{ staples_challenge.staples_store.store_no }} - {{ staples_challenge.staples_store.store_name }}
                    							<br/>
                  								{{ staples_challenge.staples_store.address }} {{ staples_challenge.staples_store.city }}
											</span>
										{% else %}
											{% if challenge.time_in %}
											<span class="total-hours">{%trans "Checked in on" %} {{ challenge.time_in }}</span>
											{% else %}
											<span class="total-hours">{%trans "Not checked in" %}</span>
											{% endif %}
										{% endif %}
									</div>
								</td>
								<td class="total-hours">
									{{ challenge.total_hours }}
								</td>
								<td class="total-clean-creds">
									{{ challenge.total_clean_creds }}
								</td>
							</tr>
							{% endfor %}
							{% endif %}
						</tbody>
					</table><!-- /.table.table-hover -->
				</div><!-- /.table-container -->

			{% else %}
				<p style="text-align: center;">{%trans "There are no Actions you are partcipating in." %}</p>
			{% endif %}
      	</div><!-- /#white-box -->

    </div><!-- /.container -->
  </div><!-- /.about -->
</div> <!-- /.wrapper -->

<div class="popup-container">
	{% for challenge in posted_challenges %}
	<div id="view-challenge-qrcode-{{ challenge.id }}">
		<h1>{{ challenge.title }}</h1>
		<img src="{{ MEDIA_URL }}{{ challenge.qr_code.qr_image }}" alt="" />
	</div>
	{% endfor %}
</div>
{% include "_footer_navbar.html" %}

{% endblock %}

{% block javascript %}{% endblock %}
