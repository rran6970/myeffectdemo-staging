{% extends '_public_base.html' %}

{% block title %} My Clean City - {{ challenge.title }} Participants {% endblock %}

{% block css %}
  <link href="{{ STATIC_URL }}css/mycleancity.css" rel="stylesheet">
{% endblock %}

{% block content %}

<div class="wrapper public">
  <div class="clouds"></div>

  {% include "_loggedin_navbar.html" %}  

  <a href="/" class="logo"></a>
  
  <div class="content">
    <div class="container">
    	<a href="#" onclick="history.go(-1); return false;"><div class="sign challenge-participants" id="sign-go-back"></div></a>
        <div id="white-box" class="challenge-participants">
			<h1>{{ challenge.title }}</h1>
			<table>
				<tr>
					<td class="name"><h2>Participant</h2></td>
					<td class="participated"></td>
				</tr>
				{% if challenge.type.challenge_type == "hourly" %}
					{% for participant in participants %}
						<tr>
							<td class="name">
								{% if challenge.clean_team_only %}
								<a href="/clean-team/{{ participant.clean_team.id }}">{{ participant.clean_team.name }}</a>
								{% else %}
								<a href="/users/profile/{{ participant.user.id }}">{{ participant.user.first_name }} {{ participant.user.last_name }}</a>
								{% endif %}
							</td>
							<td class="participated">
								<form class="participation-forms" action="/challenges/check-in-check-out/" method="post">
									{% csrf_token %}
									{% if challenge.clean_team_only %}
									<input type="hidden" name="participant_id" value="{{ participant.clean_team.id }}" />
									{% else %}
									<input type="hidden" name="participant_id" value="{{ participant.user.id }}" />
									{% endif %}

									<input type="hidden" name="challenge_id" value="{{ cid }}">
									{% if participant.time_in %}
										{% if participant.time_out %}
											{{ participant.total_hours }} Hours<br/>
											{{ participant.total_clean_creds }} <span class="green bold">Clean</span><span class="blue bold">Creds</span>
										{% else %}
											<input type="submit" id="confirm-btn" class="btn btn-primary dark" value="Check Out" />
										{% endif %}
									{% else %}
										<input type="submit" id="confirm-btn" class="btn btn-primary" value="Check In" />
									{% endif %}
								</form>
							</td>
						</tr>
					{% endfor %}
				{% else %}
					{% for participant in participants %}
						<tr>
							<td class="name">
								<a href="/users/profile/{{ participant.user.id }}">{{ participant.user.first_name }} {{ participant.user.last_name }}</a>
								<span>Last Checked In: {{ participant.time_in }}</span>
							</td>
							<td class="participated">
								<form class="participation-forms" action="/challenges/check-in-check-out/" method="post">
									{% csrf_token %}
									{% if challenge.clean_team_only %}
									<input type="hidden" name="participant_id" value="{{ participant.clean_team.id }}" />
									{% else %}
									<input type="hidden" name="participant_id" value="{{ participant.user.id }}" />
									{% endif %}

									<input type="hidden" name="challenge_id" value="{{ cid }}">
									<input type="submit" id="confirm-btn" class="btn btn-primary" value="Check In" />
								</form>
							</td>
						</tr>
					{% endfor %}
				{% endif %}
			</table>			
        </div><!-- /#white-box -->
    </div><!-- /.container -->
  </div><!-- /.about -->
</div> <!-- /.wrapper -->
{% include "_footer_navbar.html" %}

{% endblock %}

{% block javascript %}{% endblock %}